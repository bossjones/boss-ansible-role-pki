{% set boss__pki__tpl_group_directories = [ 'external', 'private' ] %}
{% set boss__pki__tpl_host_directories = [ 'external', 'internal', 'private' ] %}
  - 'pki/lib'
  - 'pki/ca-certificates/by-host/{{ boss__pki__fqdn }}'
  - 'pki/ca-certificates/by-group/all'
{% for group in boss__pki__inventory_groups %}
  - 'pki/ca-certificates/by-group/{{ group }}'
{% endfor %}
{% for realm in boss__pki__realms + boss__pki__default_realms %}
{%   if realm.name is defined and ((realm.enabled is undefined or realm.enabled|bool) and (realm.when is undefined or realm.when|bool)) %}
{%     for directory in boss__pki__tpl_group_directories %}
  - 'pki/realms/by-group/all/{{ realm.name }}/{{ directory }}'
{%     endfor %}
{%   endif %}
{% endfor %}
{% for group in boss__pki__inventory_groups %}
{%   for realm in boss__pki__group_realms + boss__pki__default_realms %}
{%     if realm.name is defined and ((realm.enabled is undefined or realm.enabled|bool) and (realm.when is undefined or realm.when|bool)) %}
{%       for directory in boss__pki__tpl_group_directories %}
  - 'pki/realms/by-group/{{ group }}/{{ realm.name }}/{{ directory }}'
{%       endfor %}
{%     endif %}
{%   endfor %}
{% endfor %}
{% for realm in (boss__pki__host_realms + boss__pki__group_realms + boss__pki__realms + boss__pki__default_realms + boss__pki__dependent_realms) %}
{%   if realm.name is defined and ((realm.enabled is undefined or realm.enabled|bool) and (realm.when is undefined or realm.when|bool)) %}
{%     for directory in boss__pki__tpl_host_directories %}
  - 'pki/realms/by-host/{{ boss__pki__fqdn }}/{{ realm.name }}/{{ directory }}'
{%     endfor %}
{%   endif %}
{% endfor %}
